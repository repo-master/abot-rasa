version: "3.1"

rules:
- rule: User wants to perform aggregation on loaded data or change aggregation method
  steps:
  - intent: intent_perform_aggregation
  - action: action_aggregation

- rule: Special case quantile
  steps:
  - intent: intent_perform_aggregation_quantile
  - action: form_aggregation_percentile
  - active_loop: form_aggregation_percentile
  - slot_was_set:
    - requested_slot: quantile
  - slot_was_set:
    - quantile
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: action_aggregation

- rule: Special case compliance
  steps:
  - intent: intent_perform_aggregation_compliance
  - action: form_aggregation_compliance
  - active_loop: form_aggregation_compliance
  - or:
    - slot_was_set:
      - requested_slot: compliance_bound_lower
    - slot_was_set:
      - requested_slot: compliance_bound_upper
  - slot_was_set:
    - compliance_bound_lower
  - slot_was_set:
    - compliance_bound_upper
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: action_aggregation

- rule: Some value that the user needs more details of.
  steps:
  - intent: ask_followup_summary_details
  - action: action_describe_event_details

- rule: Even more specific details about outliers
  steps:
  - intent: ask_count_of_outlier
  - action: action_describe_outlier_count
